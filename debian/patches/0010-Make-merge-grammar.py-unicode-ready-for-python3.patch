From: SZALAY Attila <sasa@debian.org>
Date: Sun, 28 Jan 2018 18:05:52 +0100
Subject: Make merge-grammar.py unicode ready (for python3)

---
 lib/merge-grammar.py | 17 +++++++++--------
 1 file changed, 9 insertions(+), 8 deletions(-)

diff --git a/lib/merge-grammar.py b/lib/merge-grammar.py
index 053d8d2..98ea17d 100755
--- a/lib/merge-grammar.py
+++ b/lib/merge-grammar.py
@@ -1,4 +1,5 @@
 #!/usr/bin/env python3
+# -*- coding: utf-8 -*-
 #############################################################################
 # Copyright (c) 2010-2017 Balabit
 #
@@ -39,10 +40,10 @@ if not os.path.isfile(grammar_file):
     sys.exit('Error opening cfg-grammar.y')
 
 def include_block(block_type):
-    start_marker = 'START_' + block_type
-    end_marker = 'END_' + block_type
+    start_marker = b'START_' + block_type
+    end_marker = b'END_' + block_type
 
-    with open(grammar_file) as f:
+    with open(grammar_file, mode="rb") as f:
         in_block = False
         for line in f:
             if start_marker in line:
@@ -52,11 +53,11 @@ def include_block(block_type):
             elif in_block:
                 print(line, end='')
 
-for line in fileinput.input():
-    if 'INCLUDE_DECLS' in line:
-        include_block('DECLS')
-    elif 'INCLUDE_RULES' in line:
-        include_block('RULES')
+for line in fileinput.input(mode='rb'):
+    if b'INCLUDE_DECLS' in line:
+        include_block(b'DECLS')
+    elif b'INCLUDE_RULES' in line:
+        include_block(b'RULES')
     else:
         print(line, end='')
 
